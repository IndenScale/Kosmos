[supervisord]
nodaemon=true
user=root

[program:content_extraction_worker]
command=dramatiq backend.app.tasks.broker --queues content_extraction --processes 1 --threads 1
directory=/app
environment=PYTHONPATH='/app',DRAMATIQ_SKIP_PROMETHEUS='1',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:chunking_worker]
command=dramatiq backend.app.tasks.broker --queues chunking --processes 1 --threads 1
directory=/app
environment=PYTHONPATH='/app',DRAMATIQ_SKIP_PROMETHEUS='1',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:indexing_worker]
command=dramatiq backend.app.tasks.broker --queues indexing --processes 1 --threads 1
directory=/app
environment=PYTHONPATH='/app',DRAMATIQ_SKIP_PROMETHEUS='1',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:asset_analysis_worker]
command=dramatiq backend.app.tasks.broker --queues asset_analysis --processes 1 --threads 1
directory=/app
environment=PYTHONPATH='/app',DRAMATIQ_SKIP_PROMETHEUS='1',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:content_extraction_trigger]
command=python -m backend.app.tasks.content_extraction.trigger
directory=/app
environment=PYTHONPATH='/app',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:chunking_trigger]
command=python -m backend.app.tasks.chunking.trigger
directory=/app
environment=PYTHONPATH='/app',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:indexing_trigger]
command=python -m backend.app.tasks.indexing.trigger
directory=/app
environment=PYTHONPATH='/app',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:asset_analysis_trigger]
command=python -m backend.app.tasks.asset_analysis.trigger
directory=/app
environment=PYTHONPATH='/app',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0

[program:event_relay]
command=python -m backend.app.tasks.event_relay
directory=/app
environment=PYTHONPATH='/app',DATABASE_URL='%(ENV_DATABASE_URL)s',REDIS_URL='redis://%(ENV_REDIS_HOST)s:%(ENV_REDIS_PORT)s/%(ENV_REDIS_DB)s'
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stderr_logfile=/dev/stderr
stdout_logfile_maxbytes=0
stderr_logfile_maxbytes=0